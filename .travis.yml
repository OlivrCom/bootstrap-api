# sudo: required
language: node_js
node_js:
  - "node"
services:
  - docker
before_script:
  - npm install -g lab
  - npm install -g codeclimate-test-reporter
after_script:
  - codeclimate-test-reporter < lcov.info
before_install:
  # iromain/api-bootstrap refers to https://hub.docker.com/r/iromain/api-bootstrap
  - docker build -t iromain/api-bootstrap . > docker-build.log 2>&1
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - docker push iromain/api-bootstrap

deploy:
  - provider: heroku
    api_key:
      secure: nKrNGlvXdCAVBaIFkkajRaAx9XnQrtAwvnOX6DwNdLe2ic0ZJl8/QPt54nt7WX1+8ik/yRtmRswzc5XxIDCob3s7f2tjTfjE9xXYocB9LkahwV5VH2omnW1FwdCOJbkWiuzb3F+ffJfExNrltjWeWKHplQ3RSvSLpNQe48iYa5bppQZtFaAJQRT2k4fLu2oS5T7Bx0FI+e5FTFVLRMXqMk3OBTV4xK4A0Q9VPqNLc31yIJH1o+LEYisbbFqIdL1E4v/JhvjYVKPknqru3Hkg6cwpVnOyDMHCaGd8MZw7bKTD8xI/u+8C8KTCXq2LAx3oTi+jpPq68fjRRrHQl6vrdAYEjB90iEWJjqDx33yjMFawggQOewwZ88IaYli1AQHtwIlG6i1NJ4wWJz4OxXtycVC3U8bxhRNHCMfDbDqrxEDO1VBm3JRaOEEPQ1gJMB0ODr3EIgCHdCvwA6FHBHrSy+WP2+eXGJ0cuVY/51aUpIjdyrLuK31yZezW48HjUctmT31nmmUexPzPu5sqX1qJf/17+GRQ7BuoFAlz7v6OfrsnwFLnSdS9fz9ejD39NOzq4OoB+DyiudRd2wzn6a3DQbwu8G6q2+u5O3ZP6ubL1CwilkX43HjLWjCB7joEb3Mjv2GX4LBStM+iPvRSlEwbO1H3AEP+aZPHcs7AVGVe0QE=
    app: api-bootstrap
    on:
      # iRomain/api-bootstrap refers to https://github.com/iRomain/api-bootstrap
      repo: iRomain/api-bootstrap
#  - provider: cloudfoundry
#    edge: true
#    organization: romain
#    space: dev
#    api:
#      secure: UwQTXYXjU0n4o9PDWezZ4H70nLuq2UY0GE4f2PLmvE5hMzoz5jQnVdoGxpqKqtTZKBuRsjKinIhOIcyofM4YvGBTg+MfLfvYMESEVWOj15SCogWY04JWicjV/kmEURxR3xnbPGNdGPChjvK5rA6wqDg+wZgSIxp6IGYIYWpP4lnNqZpE1U7z5G99gt5OMHu3Zz7eo7KZTzLT1cQneXRZNihOAMdM4KMjfR9QTp3vVCGSwR5CQZSu+P9GbwBZ6XzrmjUU23Dgs2aEcOOekj5F3HqAF9Isl4oxOEOSg7Gm/up6EvTmfwFf9ncSvcAc5wmPLVsN12A5O4Kd+YK/O3Cg/R1+CivqG0ZPjYP5A26sghkDhntpuB+aXv005IbxycuwbjdNjcby42EMCnVpDkXy9RQ8RoNubRp1HI/nd4EZJkKQ2Pod06yW547J6CAbACTv1lu1Qr1MhMEvIWYK/mQqwaX9x5i4UIPO7Y3/LXltjJ+7Q9gUz+DFOFvXyA7Ha8k95ySh9NoOj8ZS30BiebCL6G1USAyFx3aINBJx85fTZprXs53o5V8860Ru+sUL9POWRDwJeyC0YEU0y3wEbutfutmfTMiXOL5FISl1hxaCbl9OO5Bu+MjoqCRDV/G2FKZvzbYWurISLYIfrWwG5fIxPSRUtWs+3VNqFMTKyRN+pBI=
#    username:
#      secure: PfQasOZvMaCWaWf3xf67rmBJLsKfTKEDvEixuxN3GDV1S9Vr2V/oexyemOl3SJOmhuMOAt9yREQootcR3pfubEJyUOrbpH4s8pVOHiJbtR8U+HyFsdslQB3lozeeHYbvds8nIZxNRxvMl30eECUqOPuTRwOhlQo//XHP4hcSvZAEEpUBZKjcj/OZNvx5xCjMFWE8t275mFjp9MAbi0LbSfiwdtEeBeFpXo9zZCeXFKRpEgb8QKVLcp4WxVjMs2aSY9OHgw7ktuG9fCFvt0Ekp2o0WylF9AS6V+hh7INnop9O3aoJgtaKa2pzOIDOD/6C1AtHhX5Iu9XI0J00Ci+lSxj5ppkNl8uCovYiW17SNR4nJnaZkKHwR5i6rcnmWE3pX7k716uSgEF4eR9Xz/1Wo8Y5+Y5CqENph+/9V9iss+qMbr4jU/9hL6S62YyMpzGSWmC2PJFGsvLIcIEMvdG3kbsRmVmNVG/+3e7/hFNKkxyKEKQ0cwdqxfZeTJYsULObJU+qduruyaWKHTEeBHKW9WcrRszQu7xmZqeIjoIKg4G3X4frTld/Ea2YDmhl73Um1nRLhiVt7fLy0m2MiAstMaLmspaGQ8nAAFOHmmj5bFN44imZzphX2aoc8i92EXipNMK8pg5bGY5pBASZyoa/f0z/IK+MkaBK2VaElNVOyQI=
#    password:
#      secure: OsJkfhKwFsWmmD+a/DPajkv9Nqu9hjzbxcxh9OP+9mH6aiVa4PMtxvkGjp2zT2YbmNPDpFq6kMaY9+QbQDW3xD20K8TODVB3fWoXvAe7nZk38B7lhZl9CwJJO1Eaweg13k30HYmypO/xubvUQ1PrX+ZXFFiXbibFELEzH3QSK7b72vfFvuh7owLrXH3uvkwSSbx5dRZpmCSrxjdS2kJJ8uSkSAxNTEDyxaqsLUEe1CD20wgTfg8x8cSQuJ+ZqGHdSjhH+QZQK8WIfu9L1GVQHSYb9tfi7YvAupFbnNbIzuacnHmlLnWWXMx3V7KXLhU5eqFtiSiuojNowB18qj+zmc+bldT1ITgwuDDa4N4LtMgN7/9YfqR3iGh7O9riyU5QaLT8ycVRe96pZQJyUa99lpyi5VJgZoF4EYuHmAI8SX2Q5APAr9uBRTqkXic+C+/G6nVc1x2Ovv7DObVZiuPqtGPken2QoxbdorqhAyhEE6leVBxgNux0rc/Udb2Id1tRTo6lVUFDtQwqIiHRs7Q3IkwrpZmTciwOH643T8TZutns5yz1UY0E3Ah0raLBBqf7i3y2S2WnjI9DfXTDOsgK88VE1Krlo5HYepIxsllY8pKEdJa5/myZt9QD5DVNByHp54VhjAYNw3/6XIz8DXpBpaZvotoj15INjKXB1mUWkv0=
cache:
  directories:
  - node_modules
env:
  global:
    - NODE_ENV=test
    - DOCKER_USERNAME=iromain
    # travis encrypt DOCKER_EMAIL=your@ema.il
    - secure: doTA/m0k7fwh5STxjhS6xvR+Pi5EkRK3/agO8NTPvo3H3VjHz4R7vN4rB0Gxe/CPi58yz1vmAuY+oiN3N3pJOH1v5h64gG8Bqn1KaAd3y/cE/xlkt5Nttr4QkQvwU+MDEQZDjcDWjP2xuuCLfg4pHPJvabVEN0yyYdWx5EzYKFiygVFLPPBKgtqljlxc/z16If2igaP7xP+JDwjaeN/V/29F+vo3hkPPSvFhr5GVy0AeQfJIO9E6puc0Q6Z8mVMwk4ThHS7UiW6A1s1vEsUajQTzY0sOgsUHNO9fVCtUHb0/+81hKCHD4NOQwmFOGTXqhn2kezqOazohjKYlQCnB5xI0Z2hQuBAcmdiuzMCVWY9R1bNQDNzEDKc+e7q65O2ab3npzJ7t11Pdn15WZBPTYflgnLAH5N36mahNiUYJgSBGZeWZ58K9h8Pgm5X7zRpQIvBQrDcCFRBpcmxD90AnciswjlqW3kArRq6CPn7R3Ye3ioTQqGPf6jUilsydpocWoECsNd6wn1VAr0wTS8q5oYwuP+AmWIejuzt5p8M+FiISZbQwcZzZGVOWSCOZwqzuPoSEedMoVNHj55geLB3WUvu8CKYSZCC3Obi1HZRnCPEX4H8kjV1aaMlgYstnmtIXVSbBlsyjP6rak3hzReO6rioZquVYKe9AjW4RBeH8tU0=
    # travis encrypt DOCKER_PASSWORD=password
    - secure: VSppJD+TkHozdjBMceut5HzMRyLU7su+9r3K6zpGOC0g1KCufMdJKGYdxqslRv1QRAxod4fCGyFv4F1Qvu+e4nEUMRxuGQjo9GXhkU6Z1anKRbkVZ0Vpq+INIoFowB1j5qUKqsE5iARDPNHvN5vv+d6Jg/+2fP+SRUy06TiPT9Kz/TLNNB3pzAxplqO6xX4FB3xwyRsr1gz8Q1Q4dYbeDVI0QUMlq5IATlCqD/OxOijaMIS4xQGtj26Lf9ZKqeS81iZwf6t68GeJXNXU0ZZTwD0h0Zmtom4vsQedTXVZS/5WaPdimOSh09AJcftZ+YKX2jlMtCa573espNNrpkn1wTBYMcXK7X4aYnheK7B1bmE6ylaT6Degc+L3e9ltcLp6mxJTHKb3c5GD8ECDWqMyhIs7rDfjKeCprQsIbZ9aSi8ryLeiXEyGsqq25KRzN6+YLpGBic6Oc71y985/ZmTqZHidJXSvdC9MsDPhA9a3uBhHBlQCqei7iwArRAYdDRfgOyg1CcZy+8GmtMC7h+12o1x5ygkFPDGR1yM0q/buvZBJokmaKDL66pFvG4iA31X2ozP07x+fO4U3q4DnXqfQiJP/a0qGCLebmk6vYiUVg7TmYD5n/uaBTQURPDKbNUSg7+I3emHWZqgUwESeotRYbXr5N+Gpnom6gyRMT/VRWcs=
addons:
  code_climate:
    repo_token:
      secure: G/8d392Ccqby6+lf5gJx+z0EKTvSriMr3HnVkxJWwq4tH3w0/iQCslA7mF7ij1xyFUY7V4tT8CDQoP90wiwRNZwM4/jBpwojAR4wM1RVtdcjcoI638F6F7nGdaqYSHg8DVLUHYJKGToSUEd7qNw5NiEkt9Di4n+LA0egyactqfcxfbNM0npXih22OK1swsQ3r8cYznHRDKXyYAcPKI81xaqtaxC+a+pYynIokLYwPyJiEB9e2AmOoZBN4BA6lzag9xKJ7r7wA9G3KRJ69RGXO4J3sAwFPNiOcUSCURyWRbo/STvV84cSD4H283fTvy3yyFxxQQuxQMyJx9ClzpHiA10KB2iM0gwWhzAd4J4hYThtbHL/+1Gdp0UaSypY2sRa0F7haUsD/XptAVK20Jp7B9olZD7vp4H2wRneVYDwhZrvmp1R3K2mlNe7ogNi0Y01rIX3bCCX7v1C+d0XhD5mGJUDxBTkpneG9Q7U34N9hydCIqIL2BxAw0QCidp+2SICOVqWpCVtxqXtSt9otnb3/cCgTP6loqFUtCepFUBPpyiVSTWUr3Kll2M+doc+qpNIyOpajmDdu00fvH2w+t9WfF1e5/5jxrsaCvr6WxDB/G4UIY4PUsjyPaiVZ2yGaOS4H4kourIRaFQbrcuf6HFqhGb9oJytYinrG68g1SvkXTQ=
